/*! github.com/gillescochez/laboite */
(function(a){var b=a(window),c=a(document);a.laboite=function(d){var e=this,f,g,h,i,j=[],k=[],l=!1,m=null,n=!1,o,p;a.extend(e,{name:"laboite",version:"2.0",init:function(b,c,d,j){f=a.extend({},a.laboite.defaults,b),g=a.extend({},a.laboite.layouts,c),h=a.extend({},a.laboite.effects,d),i=a.extend({},a.laboite.languages,j),o=f.defaultIndex,f.data?e.call("run"):e.call("getData")},run:function(){f.data&&(e.call("resetCount"),e.call("buildUI"),e.inject&&e.injectType=="replace"?e.call("goToId",n):d.live(f.onEvent,function(b){b.preventDefault(),f.inject?e.call("goToId",a(this).index()):e.call("open",this)}))},buildUI:function(){m=e.call("getLayout",f.layout),a('[class^="'+f.css.prefix+'"]',m).each(function(b){var c=this.className,d=c.split(" "),g=c.length-1;if(g)for(var h=0;h<g;h++)if(d[h]&&d[h].indexOf(f.css.prefix)!==-1){var i=d[h].replace(f.css.prefix,"");j[i]=a(this),a.isFunction(e[i])&&j[i].click(function(a){a.preventDefault(),e.call(i)})}}),f.slideshow||(a.each(["play","pause","stop"],function(a,b){j[b]&&j[b].hide()}),m.addClass(f.css.prefix+f.css.slideshowDisabled));if(f.inject){var b=a(f.injectTarget);if("append"==f.injectType||"prepend"==f.injectType)b[f.injectType](m);else if("replace"==f.injectType)b.html(m);else return e.error("invalid injectType"),!1;l=!0,e.call("goToId",f.defaultIndex)}else m.css("opacity",0),f.dimmer&&(j.dimmer=a('<div class="'+f.css.prefix+f.css.dimmer+'" />').hide().bind("click",function(){e.call("close")}).appendTo("body:eq(0)"))},goToId:function(a){if(a>=0&&a<=f.__count-1)e.call("load",a);else if(f.continuous){if(a<0)var b=f.__count-1;else var b=0;e.call("load",b)}},open:function(b){e.call("openDimmer"),l?m.fadeTo(f.dimmerFadeDuration,1):(m.appendTo("body:eq(0)").fadeTo(f.dimmerFadeDuration,1),e.call("positionUI"),l=!0),e.call("modalBind"),e.call("goToId",a(b).index())},close:function(){e.call("closeDimmer"),m.fadeTo(f.dimmerFadeDuration,0,function(){m.hide()}),e.call("modalUnbind")},play:function(){e.t=setInterval(function(){e.call("next")},f.slideshowDelay)},pause:function(){clearInterval(e.t)},stop:function(){e.call("pause"),e.call("goToId",0)},next:function(){e.call("goToId",n+1)},previous:function(){e.call("goToId",n-1)},switchItem:function(b){e.call("hideItem",function(){j.content.children().hide(),a(k[n]).show(),e.call("showItem")})},hideItem:function(b){var c=h[f.effect||"none"].hide,d={};b&&(d.complete=b),a.extend(d,c.config),j.content.css(c.init||{}).animate(c.css,d)},showItem:function(b){var c=h[f.effect||"none"].show,d={};b&&(d.complete=b),a.extend(d,c.config),j.content.css(c.init||{}).animate(c.css,d)},hideLoader:function(){j.loader&&j.loader.hide()},showLoader:function(){j.loader&&j.loader.show()},load:function(a){n=a,k[a]||e.call("showLoader"),e.call("hideItem",function(){var b=e.call("getType",a);e["load"+b]?e.call("load"+b,a):e.call("loadIframe",a)})},getType:function(a){var b="Image";if(!f.loadAsImage)if(f.data.items[a].type)b=p.items[a].type;else{var c=f.data.items[a].source,d=c.split("."),e=d[d.length-1];e==="swf"?b="Swf":c.substr(0,1)=="#"?b="Element":/jpg|jpeg|png|gif|bmp|tiff|svg/.test(e)||(b="Iframe")}return b},loadImage:function(b){if(k[b]){k[b].show(),e.call("resizeContainer",k[b].width(),k[b].height());return}var c=new Image,d=f.data.items[b].source||!1,g=f.data.items[b].title||"";if(!d)return e.error('source not found for index "'+b+'"'),!1;c.onload=function(){k[b]=a(c),j.content.children().hide().end().append(k[b]),e.call("resizeContainer",k[b].width(),k[b].height())},c.src=d,c.title=g},loadElement:function(b){if(k[b]){k[b].show(),e.call("resizeContainer",k[b].width(),k[b].height());return}var c=f.data.items[b].source||!1,d=f.data.items[b].title||"",g=f.elementClone?a(c).clone():a(c);k[b]=g,j.content.children().hide().end().append(g.show()),e.call("resizeContainer",k[b].width(),k[b].height()),e.call("showItem")},loadSwf:function(b){if(k[b]){k[b].show(),e.call("resizeContainer",f.flashWidth,f.flashHeight);return}var c=a("#"+e.name+"Swf"+b).size()?a("#"+e.name+"Swf"+b):!1,d=c||a("<div />").attr("id",e.name+"Swf"+b),g=f.data.items[b].source||!1,h=f.data.items[b].title||"",i=function(){j.content.children().hide().end().append(d),swfobject.embedSWF(g,e.name+"Swf"+b,f.flashWidth,f.flashHeight,f.flashVersion),e.call("resizeContainer",f.flashWidth,f.flashHeight),k[b]=a("#"+e.name+"Swf"+b)},l;window.swfobject?i():a.getScript(f.SWFObject,i)},loadIframe:function(b){if(k[b]){k[b].show(),e.call("resizeContainer",f.iFrameWidth,f.iFrameHeight);return}var c=a("<iframe />").css({width:f.iFrameWidth,height:f.iFrameHeight,border:"none"});c.attr("src",f.data.items[b].source),c.bind("load",function(){k[b]=c,e.call("resizeContainer",f.iFrameWidth,f.iFrameHeight)}),j.content.children().hide().end().append(c)},resizeContainer:function(a,b){if(!f.resize){e.call("showItem");return}f.maxHeight&&b>f.maxHeight&&(b=f.maxHeight),f.maxWidth&&a>f.maxWidth&&(a=f.maxWidth),f.minHeight&&b<f.minHeight&&(b=f.minHeight),f.minWidth&&a<f.minWidth&&(a=f.minWidth),j.container.animate({height:b,width:a},{duration:f.resizeDuration,easing:f.resizeEasing,step:function(){e.call("positionUI")},complete:function(){e.call("showItem")}})},positionUI:function(){if(f.modalTarget){var b=a(f.modalTarget),c=b.offset();c!=null&&m.css({top:c.top+f.modalOffsetTop,left:c.left+f.modalOffsetLeft})}else e.call("centerUI")},centerUI:function(){var a={w:m.width(),h:m.height()},c={w:b.width(),h:b.height()},d=parseInt((c.h-a.h)/2),e=parseInt((c.w-a.w)/2);d<0&&(d=0),e<0&&(e=0),m.css({top:d,left:e})},getLayout:function(){var b;return g[f.layout]?i[f.lang]?(b=g[f.layout](),a.each(i[f.lang],function(a,c){b=b.replace(new RegExp("\\${"+a+"}","g"),c)}),a(b)):(e.error(f.lang+" language not found!"),!1):(e.error(f.layout+" layout not found!"),!1)},openDimmer:function(){if(f.dimmer&&j.dimmer){if(f.dimmerMatchBackground){var b=a("body:eq(0)"),d="background-",e=[d+"color",d+"image",d+"repeat",d+"position"];a.each(e,function(a,c){var d=b.css(c);d!=""&&j.dimmer.css(c,d)})}j.dimmer.css({position:"absolute",height:c.height(),width:c.width(),left:0,top:0}).fadeTo(f.dimmerFadeDuration,f.dimmerOpacity)}},modalBind:function(){b.bind("resize."+e.name+" scroll."+e.name,function(){j.dimmer.css({height:c.height(),width:c.width()}),e.call("centerUI")}),f.modalKeepAtCenter&&c.bind("scroll."+e.name,function(){e.call("centerUI")})},modalUnbind:function(){b.unbind("resize."+e.name+" scroll."+e.name),c.unbind("scroll."+e.name)},closeDimmer:function(){j.dimmer.fadeTo(f.dimmerFadeDuration,0,function(){j.dimmer.hide(),b.unbind("resize."+e.name)})},addEffect:function(a,b,c){h[a]&&!overwritte?e.error(a+"already exists!"):h[a]=b},resetCount:function(){f.__count=f.data.items.length},getData:function(){f.dataUrl?a.ajax({url:f.dataUrl,dataType:f.jsonp?"jsonp":"json",error:function(){e.error(f.dataUrl+" not found")},success:function(a){a.items&&(f.data=a,e.call("run"))}}):e.call("getDataFromDom")},getDataFromDom:function(){var b=[];f.data={},d.each(function(c){var d=a(this);b[c]={},a.each(f.attributes,function(a,e){var f=d.attr(e);f&&(b[c][a]=f)})}),f.data.items=b,e.call("run")},call:function(a){f.callbacks[a+"Before"]&&f.callbacks[a+"Before"](),e.log(a+"("+Array.prototype.slice.call(arguments,1)+")");var b=e[a].apply(null,Array.prototype.slice.call(arguments,1));return f.callbacks[a+"After"]&&f.callbacks[a+"After"](),b||e},get:function(a){if(!a)return f;if(f[a])return f[a];e.error("get("+a+") "+notfound)},set:function(a,b){if(!a&&!b)return e.error("set() missing arguments"),!1;f[a]=b},error:function(a){if(f.debug){a=e.name+": "+a;if(console.error)console.error(a);else throw a}},log:function(a){f.log&&console.log&&(a=e.name+": "+a,console.log(a))}})},a.laboite.defaults={lang:"en",log:!1,debug:!1,data:!1,dataURL:!1,jsonp:!1,layout:"modal",inject:!1,injectType:"append",injectTarget:"",modalAtCenter:!0,modalKeepAtCenter:!0,modalTarget:null,modalOffsetTop:0,modalOffsetLeft:0,resize:!0,resizeDuration:350,resizeEasing:"linear",slideshow:!1,slideshowDelay:3500,elementClone:!1,iFrameWidth:640,iFrameHeight:480,flashWidth:640,flashHeight:480,flashVersion:"9.0.0",SWFObject:"https://ajax.googleapis.com/ajax/libs/swfobject/2.2/swfobject.js",maxWidth:null,maxheight:null,minWidth:null,minheight:null,dimmer:!0,dimmerOpacity:.5,dimmerBindToClose:!0,dimmerFadeDuration:250,dimmerMatchBackground:!1,effect:"fade",defaultIndex:0,continuous:!1,callbacks:{},autorun:!0,onEvent:"click",loadAsImage:!1,transitionDuration:1e3,css:{prefix:"laboite-",play:"play",pause:"pause",stop:"stop",previous:"previous",next:"next",autorun:"autorun",items:"items",item:"item",itemWrap:"item-wrap",slideshowDisabled:"slideshowDisabled",slideshowOn:"slideshowOn",slideshowOff:"slideshowOff",itemLoading:"itemLoading",itemLoaded:"itemLoaded",dimmer:"dimmer"},attributes:{title:"title",source:"href",maxWidth:"data-laboite-maxWidth",maxHeight:"data-laboite-maxHeight",minWidth:"data-laboite-minWidth",minHeight:"data-laboite-minHeight",link:"data-laboite-link",linkTarget:"data-laboite-linkTarget",description:"data-laboite-description"}},a.laboite.effects={none:{hide:{css:{display:"none"},config:{duration:0}},show:{css:{display:""},config:{duration:0}}},fade:{hide:{css:{opacity:0},config:{duration:1e3}},show:{css:{opacity:1},config:{duration:1e3}}}},a.laboite.languages={en:{close:"Close",previous:"Previous",next:"Next",play:"Play",pause:"Pause",stop:"Stop",stats:"${current} out of ${total}"}},a.laboite.layouts={modal:function(){var a='<div class="laboite-wrap laboite-modal">';return a+='<a href="#close" class="laboite-close"><span>${close}</span></a>',a+='<div class="laboite-container"><div class="laboite-content"></div></div>',a+='<div class="laboite-controls">',a+='<a href="#previous" class="laboite-button laboite-previous"><span>${previous}</span></a>',a+='<a href="#next" class="laboite-button laboite-next"><span>${next}</span></a>',a+='<a href="#play" class="laboite-button laboite-play"><span>${play}</span></a>',a+='<a href="#pause" class="laboite-button laboite-pause"><span>${pause}</span></a>',a+='<a href="#stop" class="laboite-button laboite-stop"><span>${stop}</span></a>',a+='<span class="laboite-stats"></span>',a+="</div>",a+="</div>",a},inline:function(){var a='<div class="laboite-wrap laboite-inline">';return a+='<div class="laboite-controls">',a+='<a href="#previous" class="laboite-button laboite-previous"><span>${previous}</span></a>',a+='<a href="#next" class="laboite-button laboite-next"><span>${next}</span></a>',a+='<a href="#play" class="laboite-button laboite-play"><span>${play}</span></a>',a+='<a href="#pause" class="laboite-button laboite-pause"><span>${pause}</span></a>',a+='<a href="#stop" class="laboite-button laboite-stop"><span>${stop}</span></a>',a+='<span class="laboite-stats"></span>',a+="</div>",a+='<div class="laboite-container"><div class="laboite-content"></div></div>',a+="</div>",a}},a.fn.laboite=function(){if(!a(this).data("laboite"))a(this).data("laboite",new a.laboite(this)),a(this).data("laboite").init.apply(null,arguments);else if(arguments.length&&arguments[0].constructor==String&&a.isFunction(a(this).data("laboite")[arguments[0]]))var b=a(this).data("laboite")[arguments[0]].apply(null,Array.prototype.slice.call(arguments,1));return b||this}})(jQuery)